<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>User Profile</title>
    <link rel="stylesheet" th:href="@{~/css/styles.css}">
</head>
<body>
<nav th:insert="~{fragmentExample/fragments/nav.html}"></nav>
<h1>User Profile</h1>

<div class="UserProfilePicContainer">
    <div class="UserProfilePic">
        <img th:src="@{${'/uploads/' + profilePic}}" alt="Profile Picture">
    </div>
</div>
<div class="ChangeProfilePictureButtonContainer">
    <button type="button" id="changePicture" onclick="redirectToUploadPage()"> + </button>
</div>

<div>

    <form id="profileForm" action="/user" method="get">

        <label for="firstName"> First Name: </label>
        <span id="firstName" th:text="${firstName}"></span>
        <input autofocus class="form-control" data-cy="firstName" id="firstNameEdit"
               placeholder="First Name" required th:name="firstName" th:value="*{firstName}" type="text" style="display: none;">
        <p th:text="${firstNameValid}"></p>
        <br/>
        <label for="lastName"> Last Name: </label>
        <span id="lastName" th:text="${lastName}"></span>
        <input class="form-control" data-cy="lastName" id="lastNameEdit" placeholder="Last Name"
               th:name="lastName" th:value="*{lastName}" type="text" style="display: none">
        <br/>
        <input class="form-control" data-cy="lastNameCheck" id="lastNameTickBox" name="lastNameCheck" placeholder="Last Name Tick Box Check"
               th:name="lastNameCheck" th:value="lastNameCheck" type="checkbox" style="display: none;">
        <label id="lastNameCheckLabelEdit" style="display: none;">I have no surname</label>
        <script>
            document.getElementById('lastNameTickBox').checked = false;
            document.getElementById('lastNameTickBox').onchange = function () {
                document.getElementById('lastNameEdit').disabled = this.checked;
            };
        </script>
        <p th:text="${lastNameValid}"></p>
        <br/>
        <label for="DoB"> Date of Birth: </label>
        <span id="dob" th:text="${DoB}"></span>
        <input class="form-control" data-cy="DoB" id="dobEdit"
               th:name="DoB" th:value="*{DoB}" type="date" style="display: none;">
        <p th:text="${DoBValid}"></p>
        <br/>
        <label for="email"> Email: </label>
        <span id="email" th:text="${email}"></span>
        <input class="form-control" data-cy="email" id="emailEdit" placeholder="Email"
               th:name="email" th:value="*{email}" type="text" style="display: none;">
        <p th:text="${emailValid}"></p>
        <br/>

        <div id="editButtonDiv">
            <button type="button" onclick="enableEditing()">Edit</button>
        </div>
        <div id="saveCancelButtonDiv" style="display: none;">
            <button type="submit" onclick="saveProfile()">Save</button>
            <button type="button" onclick="disableEditing()">Cancel</button>
        </div>
    </form>
</div>
<script>

    function redirectToUploadPage() {
        window.location.href = '/upload';
    }
    function enableEditing() {
        document.getElementById('editButtonDiv').style.display = 'none';
        document.getElementById('saveCancelButtonDiv').style.display = 'block';

        document.getElementById('firstName').style.display = 'none';
        document.getElementById('firstNameEdit').style.display = 'inline';

        document.getElementById('lastName').style.display = 'none';
        document.getElementById('lastNameEdit').style.display = 'inline';
        document.getElementById('lastNameTickBox').style.display = 'inline';
        document.getElementById('lastNameCheckLabelEdit').style.display = 'inline';
        var lName = document.getElementById('lastNameEdit');
        if (lName.value.trim() === "") {
            document.getElementById('lastNameTickBox').checked = true;
            document.getElementById('lastNameEdit').disabled = true;
        }

        document.getElementById('dob').style.display = 'none';
        document.getElementById('dobEdit').style.display = 'inline';

        document.getElementById('email').style.display = 'none';
        document.getElementById('emailEdit').style.display = 'inline';

        document.getElementById('passwordTitle').style.display = 'inline';
        document.getElementById('passwordInput').style.display = 'inline';
    }

    function disableEditing() {
        document.getElementById('editButtonDiv').style.display = 'block';
        document.getElementById('saveCancelButtonDiv').style.display = 'none';

        document.getElementById('firstName').style.display = 'inline';
        document.getElementById('firstNameEdit').style.display = 'none';

        document.getElementById('lastName').style.display = 'inline';
        document.getElementById('lastNameEdit').style.display = 'none';
        document.getElementById('lastNameTickBox').style.display = 'none';
        document.getElementById('lastNameCheckLabelEdit').style.display = 'none';

        document.getElementById('dob').style.display = 'inline';
        document.getElementById('dobEdit').style.display = 'none';

        document.getElementById('email').style.display = 'inline';
        document.getElementById('emailEdit').style.display = 'none';

        document.getElementById('passwordTitle').style.display = 'None';
        document.getElementById('passwordInput').style.display = 'none';
    }
    function saveProfile() {
        document.getElementById('profileForm').submit();
    }

</script>

</body>
</html>